---
title: 网线和mii接口总结
date: 2022-03-01 16:37:13
categories:
 - 经验和总结
tags:
 - mii
 - rmii
 - smii
 - gmii
 - rgmii
 - sgmii
 - xgmii
 - xaui
 - rxaui
---

* 各种网线的特点;
* 各种mii接口的特点;

<!-- more -->

## 双绞线

### 屏蔽

双绞线分为屏蔽双绞线(STP)和非屏蔽双绞线(UTP),屏蔽双绞线有一层**金属**隔离层,能够减少外界电池干扰.

### 类型

| 名称 | 描述 | 频率 | 速率 | 传输距离 |
| --- | --- | --- | --- | --- |
| 一类线 | 最早的电话线,只有两对线(一对收,一对发) | 750kHZ | | |
| 二类线 | 可以用于语音和数据传输,有三对线 | 1MHZ | 4Mbps | |
| 三类线 | 被ANSI/TIA-568.C.2作为最低使用等级 | 16MHz | 10Mbps | 100M |
| 四类线 | | 20MHz | 16Mbps |  |
| 五类线 | 有4对线,增加了绕线密度 | 100MHz | 100Mbps | 100M |
| 超五类线(CAT5E) | 有4对线缆,1个抗拉线,短距离也能有千兆速度 | 155MHz | 1000Mbps | 100M |
| 六类线 | 新增十字骨架,将四对线反倒四个槽内 | 250MHz | 1000Mbps | 100M |
| 超六类线(CAT6A) | 使用23AWG的无氧铜,线对外又有一层屏蔽 | 500MHz | 10Gbps | 100M |
| 七类线 | 四对线外面有一个屏蔽层,水晶头带金属屏蔽外壳 | 600MHZ | 10Gbps | 100M |
| 超七类线(CAT7A) |  | 1GHZ | 10Gbps | 100M |
| 八类线 | 传输距离短 | 2GHZ | 25G-40Gbps | 30M |

### 接线

水晶头不带卡扣那一面朝向我们时,从左到右分别是

| 标准 | TX+ | TX- | RX+ | 未使用 | 未使用 | RX- | 未使用 | 未使用 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 568A | 白绿 | 绿 | 白橙 | 蓝 | 白蓝 | 橙 | 白棕 | 棕 |
| 568B | 白橙 | 橙 | 白绿 | 蓝 | 白蓝 | 绿 | 白棕 | 棕 |

常用的是568B.

有4条线未使用,在百兆网络可以只连接4条,但是poe供电和千兆以上网络必须全连接.

## MII接口

MII是用于连接PHY和MAC的接口.

## MDIO

所有接口除了下文所说的线以外还带`MDIO`和`MDC`线.

通过这两条线`MAC`层可以控制`PHY`层的寄存器,并通过这些寄存器对物理层芯片进行控制和管理.

| 线 | 作用 |
| --- | --- |
| `MDC` | 时钟,和`TX_CLK`,`RX_CLK`无关系 |
| `MDIO` | 双向的数据线,在上升沿有效 |

`MDIO`管理接口的数据帧结构如下

| 内容 | 读 | 写 | 作用 |
| --- | --- | --- | --- |
| PRE | 32个连续的1 | 32个连续的1 | 前缀 |
| ST | `01` | `01` | |
| OP | `10` | `01` | 操作码,用来表示读还是写 |
| PHYAD | 5位 | 5位 | 物理层芯片的地址,每个芯片都把自己的地址与这5个位进行比较.若匹配则响应后面的操作,否则忽略掉后面的操作. |
| REGAD | 5位 | 5位 | 用来表示物理层芯片的32个寄存器中某个寄存器的地址 |
| TA | `Z0` | `10` | 状态转换域,读操作时,第一位为高阻态,第二位由`PHY`置零;写操作时,由`MAC`输出`10` |
| DATA | 16位 | 16位 | 数据域 |
| IDLE | 空闲 | 空闲 | 一半用上拉电阻使其出于高点平 |

## 速率对比

| 接口 | 速率 | 时钟 | 线 |
| --- | --- | -- | -- |
| MII | 10Mbps | 2.5Mhz | 16线 |
| MII | 100Mbps | 25Mhz | 16线
| RMII | 10Mbps | 50Mhz | 8线 |
| RMII | 100Mbps | 50Mhz | 8线 |
| SMII | 10Mbps | 125Mhz | 4线 |
| SMII | 100Mbps | 125Mhz | 4线 |
| GMII | 1000Mbps | 125Mhz | 24线 |
| RGMII | 10Mbps | 2.5Mhz | 16线 |
| RGMII | 100Mbps | 25Mhz | 16线 |
| RGMII | 1000Mbps | 125Mhz | 16线 |
| SGMII | 1000Mbps | 625Mhz | 至少2线 |


## MII,所有变种的祖先

mii接口一共有`16`条线.

| 线 | 作用 |
| --- | --- |
| `TXD[3:0]` | 数据发送,共`4`条线 |
| `TX_CLK` | 接受数据参考时钟,在`100Mbps`下,时钟频率为`25Mhz`,`10Mbps`速率下,时钟频率为`2.5Mhz` |
| `TX_EN` | 发送使能信号,只有在`TX_EN`有效期内传的数据才有效 |
| `TX_ER` | 发送数据错误提示信号,同步于`TX_CLK`,高电平有效.有效期内传输的数据无效.在`10Mbps`速率下不起作用 |
| `RXD[3:0]` | 数据接收,共`4`条线 |
| `RX_CLK` | 接收数据参考时钟,在`100Mbps`下,时钟频率为`25Mhz`,`10Mbps`速率下,时钟频率为`2.5Mhz` |
| `RX_DV` | 接收使能信号,只有在`RX_DV`有效期内传的数据才有效 |
| `RX_ER` | 接收数据错误提示信号,同步于`TX_CLK`,高电平有效.有效期内传输的数据无效.在`10Mbps`速率下不起作用 |
| `CRS` | 载波侦测信号,不需要同步于参考时钟,只有`PHY`在半双工模式下有效 |
| `COL` | 冲突检测信号,不需要同步于参考时钟,只有`PHY`在半双工模式下有效 |

注意,这里的`TX_CLK`也是由`PHY`提供的.即使数据由`MAC`发送.

## RMII

简化版的`MII`,减少到`8`根线.

| 线 | 作用 |
| --- | --- |
| `TXD[1:0]` | 数据发送,只有两条 |
| `TX_EN` | 发送使能信号 |
| `RXD[1:0]` | 数据接收,只有两条 |
| `RX_ER` | 接收数据错误提示信号 |
| `CLK_REF` | 由外部时钟提供的`50Mhz`时钟 |
| `CRS_DV` | 同时发送`RX_DV`和`CRS`信号,`MAC`能够从中获得两个信号 |

这里注意,因为时钟总是50Mhz,那么两条数据线总能传100Mbps才对,为什么会有10Mbps的选项呢?

其实是在10Mbps速率时,`TX/RX`每隔10个周期采样一个数据,因而`TX/RX`数据需要在数据线上保留10个周期,相当于一个数据发送10次.

## SMII及其后代

串行MII,也就是数据线只有一条,并且只需要四条线.

| 线 | 作用 |
| --- | --- |
| TXD | 发送数据 |
| RXD | 接收数据 |
| SYNC | 每10个时钟周期由`PHY`置为高点平,表示一组数据开始 |
| CLK_REF | 120Mhz,因为每8位数据中会插入2位控制信号,所以需要大于100Mhz |

在发送数据上增加的数据是`TX_EN`和`TX_ER`.

在接收数据上增加的数据是`RX_DV`和`CRS`.

使用和RMII同样的方法来实现10Mbps.

### SSMII

同步串行MII,收发使用独立的`SYNC`和`CLK`,因此比SMII多两条线.

注意这个接口的`SYNC`和`CLK`都是由`PHY`提供的,无论方向如何.

| 线 | 作用 |
| --- | --- |
| TXD | 发送数据 |
| TX_CLK | 发送时钟 |
| TX_SYNC | 发送同步时钟 |
| RXD | 接收数据 |
| RX_CLK | 接收时钟 |
| RX_SYNC | 接收同步时钟 |

### SSSMII

源同步串行MII,和上一个SSMII的区别在于,发送方的`SYNC`和`CLK`由`MAC`提供.

| 线 | 作用 |
| --- | --- |
| TXD | 发送数据 |
| TX_CLK | 发送时钟 |
| TX_SYNC | 发送同步时钟 |
| RXD | 接收数据 |
| RX_CLK | 接收时钟 |
| RX_SYNC | 接收同步时钟 |

## GMII及其后代

时钟频率提升到125Mbps,数据线变为8根,因此它能够达到千兆速度.

注意,这里的`TX_CLK`是由`MAC`提供的,这和MII不同.

同时他也兼容MII,这时候只使用4条数据线,并且时钟方向改变.


| 线 | 作用 |
| --- | --- |
| `TXD[7:0]` | 数据发送,共`4`条线 |
| `TX_CLK` | 接受数据参考时钟 |
| `TX_EN` | 发送使能信号,只有在`TX_EN`有效期内传的数据才有效 |
| `TX_ER` | 发送数据错误提示信号,同步于`TX_CLK`,高电平有效.有效期内传输的数据无效. |
| `RXD[7:0]` | 数据接收,共`4`条线 |
| `RX_CLK` | 接收数据参考时钟 |
| `RX_DV` | 接收使能信号,只有在`RX_DV`有效期内传的数据才有效 |
| `RX_ER` | 接收数据错误提示信号,同步于`TX_CLK`,高电平有效.有效期内传输的数据无效. |
| `CRS` | 载波侦测信号,不需要同步于参考时钟,只有`PHY`在半双工模式下有效 |
| `COL` | 冲突检测信号,不需要同步于参考时钟,只有`PHY`在半双工模式下有效 |

### RGMII

简化的GMII,只有14条线.

| 线 | 作用 |
| --- | --- |
| `TXD[3:0]` | 数据发送,共`4`条线 |
| `TX_CLK` | 接受数据参考时钟 |
| `TX_EN` | 发送使能信号,只有在`TX_EN`有效期内传的数据才有效 |
| `RXD[3:0]` | 数据接收,共`4`条线 |
| `RX_CLK` | 接收数据参考时钟 |
| `RX_DV` | 接收使能信号,只有在`RX_DV`有效期内传的数据才有效 |
| `CRS` | 载波侦测信号,不需要同步于参考时钟,只有`PHY`在半双工模式下有效 |
| `COL` | 冲突检测信号,不需要同步于参考时钟,只有`PHY`在半双工模式下有效 |

时钟频率依旧是125Mbps,数据线减少为4条.

为了达到1000Mbps,它在上升沿下降沿都采样数据.

上升沿发送的数据相当于原本的`TXD[3:0]`,下降沿发送的数据相当于原来的`TXD[7:4]`.接收同理.

上升沿发送使能信息,下降沿发送错误信息,从而在一条线上发送使能和错误信息.

如果降低时钟频率为25Mhz和2.5Mhz,也可以实现100Mbps和10Mbps.

### SGMII

串行的GMII,收发各一对差分信号线.时钟频率625Mhz,在上升沿和下降沿都采样.

有`CLK`,但是有时候不使用,而是直接从数据中恢复出时钟.

因为每8位数据都需要插入2位数据(使能和错误),因此传输速率实际需要达到1250Mbps=625Mhz*2(两次采样).

这也就是为什么时钟频率是625Mbps.

| 线 | 作用 |
| --- | --- |
| TXD | 发送 |
| TX_CLK | 发送时钟 |
| RXD | 接收 |
| RX_CLK | 接收时钟 |

SGMII接口可以配置成SerDes接口,直接外接光模块.

这时候虽然没有使能信号和错误信号.但625Mhz的频率还是只能传1000Mbps的数据.

因为需要直接接收`8B/10B`信号.

这种信号用10位来表示8位数据,原本是由`PHY`处理成8位信号的.

这时候因为没有了`PHY`,所以需要传给`MAC`处理.

### QSGMII

四个SGMII合在一起,实现一个5000Mbps的接口.